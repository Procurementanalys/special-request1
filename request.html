<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Store Request Form | Procurement</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
  
  * { 
    font-family: 'Inter', sans-serif;
    scroll-behavior: smooth;
  }
  
  @keyframes slideDown { 
    from { opacity: 0; transform: translateY(-20px); } 
    to { opacity: 1; transform: translateY(0); } 
  }
  @keyframes slideUp { 
    from { opacity: 0; transform: translateY(30px); } 
    to { opacity: 1; transform: translateY(0); } 
  }
  @keyframes shimmer {
    0% { background-position: -1000px 0; }
    100% { background-position: 1000px 0; }
  }
  
  .animate-slideDown { animation: slideDown 0.6s ease-out; }
  .animate-slideUp { animation: slideUp 0.6s ease-out; }
  
  .retail-gradient {
    background: linear-gradient(135deg, #2B5FCC 0%, #3B82F6 30%, #EC4899 70%, #FB923C 100%);
  }
  
  .gradient-mesh {
    background: linear-gradient(135deg, #2B5FCC 0%, #3B82F6 30%, #EC4899 70%, #FB923C 100%);
  }
  
  .card-premium {
    background: white;
    box-shadow: 
      0 0 0 1px rgba(59, 130, 246, 0.1),
      0 10px 50px rgba(59, 130, 246, 0.08),
      0 20px 80px rgba(0, 0, 0, 0.05);
    border-radius: 1.5rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .card-premium:hover {
    transform: translateY(-4px);
    box-shadow: 
      0 0 0 1px rgba(16, 185, 129, 0.2),
      0 20px 60px rgba(16, 185, 129, 0.12),
      0 30px 100px rgba(0, 0, 0, 0.08);
  }
  
  .badge-pending { 
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
  }
  .badge-approved { 
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
  }
  .badge-rejected { 
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
  }
  .badge-partial { 
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  }
  
  .table-container {
    overflow-x: auto;
    border-radius: 1rem;
    scrollbar-width: thin;
    scrollbar-color: #3B82F6 #f3f4f6;
  }
  
  .table-container::-webkit-scrollbar {
    height: 8px;
  }
  
  .table-container::-webkit-scrollbar-track {
    background: #f3f4f6;
    border-radius: 10px;
  }
  
  .table-container::-webkit-scrollbar-thumb {
    background: #3B82F6;
    border-radius: 10px;
  }
  
  .table-container::-webkit-scrollbar-thumb:hover {
    background: #2563EB;
  }
  
  input:focus, select:focus {
    outline: none;
    border-color: #3B82F6;
    box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
  }
  
  button {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  button:hover {
    transform: translateY(-2px);
  }
  
  button:active {
    transform: translateY(0);
  }
  
  .icon-gradient {
    background: linear-gradient(135deg, #3B82F6 0%, #60A5FA 100%);
  }
  
  .dropdown-item {
    transition: all 0.2s ease;
  }
  
  .dropdown-item:hover {
    background: linear-gradient(135deg, #EFF6FF 0%, #DBEAFE 100%);
    padding-left: 1rem;
  }
  
  .ticket-detail-container {
    transition: all 0.3s ease;
    overflow: hidden;
  }
  
  .shimmer-loading {
    background: linear-gradient(90deg, #f3f4f6 0%, #e5e7eb 50%, #f3f4f6 100%);
    background-size: 1000px 100%;
    animation: shimmer 2s infinite;
  }
</style>
</head>
<body class="gradient-mesh min-h-screen">

<!-- HEADER -->
<div class="retail-gradient text-white shadow-2xl animate-slideDown sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-6 py-6">
    <div class="flex flex-col md:flex-row justify-between items-center gap-4">
      <div class="flex items-center gap-4">
        <div class="w-20 h-20 rounded-2xl overflow-hidden shadow-xl">
          <img src="logo-alpro.png" alt="Alpro Apotek Pharmacy" class="w-full h-full object-cover">
        </div>
        <div>
          <h1 class="text-2xl md:text-3xl font-bold tracking-tight">Procurement Portal</h1>
          <p class="text-sm text-white/90 font-medium flex items-center gap-2 mt-1">
            <i class="fas fa-store"></i>
            <span id="store_name_display">Alpro Apotek Pharmacy</span>
          </p>
        </div>
      </div>
      <button 
        onclick="logout()" 
        class="flex items-center gap-2 bg-white/20 hover:bg-white/30 px-6 py-3 rounded-xl transition-all backdrop-blur-xl border border-white/30 font-semibold shadow-lg"
      >
        <i class="fas fa-sign-out-alt"></i>
        <span>Logout</span>
      </button>
    </div>
  </div>
</div>

<div class="max-w-7xl mx-auto py-8 px-4 md:px-6 space-y-8">

  <!-- FORM REQUEST -->
  <div class="card-premium p-6 md:p-8 animate-slideUp">
    <div class="flex items-center gap-3 mb-6 pb-4 border-b-2 border-gray-100">
      <div class="w-12 h-12 icon-gradient rounded-xl flex items-center justify-center shadow-lg">
        <i class="fas fa-plus text-white text-xl"></i>
      </div>
      <div>
        <h2 class="text-2xl font-bold text-gray-800">Buat Request Baru</h2>
        <p class="text-sm text-gray-500 mt-0.5">Tambahkan item yang dibutuhkan</p>
      </div>
    </div>

    <!-- FORM INPUTS -->
    <div class="grid grid-cols-1 md:grid-cols-12 gap-4 mb-6">
      <!-- SEARCH ITEM -->
      <div class="md:col-span-5 relative">
        <label class="block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2">
          <i class="fas fa-search text-blue-500"></i>
          <span>Cari Item</span>
        </label>
        <input 
          type="text" 
          id="itemSearch" 
          placeholder="Ketik nama item..." 
          class="w-full px-4 py-3.5 border-2 border-gray-200 rounded-xl transition-all font-medium text-gray-700"
          oninput="filterItems(this.value)"
        >
        <div 
          id="itemList" 
          class="absolute bg-white border-2 border-gray-200 rounded-xl shadow-2xl hidden z-20 w-full max-h-64 overflow-auto mt-2"
        ></div>
      </div>

      <!-- QTY -->
      <div class="md:col-span-2">
        <label class="block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2">
          <i class="fas fa-boxes text-blue-500"></i>
          <span>Quantity</span>
        </label>
        <input 
          type="number" 
          id="qty" 
          placeholder="0" 
          min="1"
          class="w-full px-4 py-3.5 border-2 border-gray-200 rounded-xl transition-all font-bold text-gray-700 text-center"
        >
      </div>

      <!-- REMARKS -->
      <div class="md:col-span-3">
        <label class="block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2">
          <i class="fas fa-comment-dots text-amber-500"></i>
          <span>Catatan</span>
        </label>
        <input 
          type="text" 
          id="remarks" 
          placeholder="Keterangan tambahan..." 
          class="w-full px-4 py-3.5 border-2 border-gray-200 rounded-xl transition-all font-medium text-gray-700"
        >
      </div>

      <!-- BUTTON ADD -->
      <div class="md:col-span-2 flex items-end">
        <button 
          onclick="addItem()" 
          class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl py-3.5 px-6 font-bold transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-2xl"
        >
          <i class="fas fa-plus-circle"></i>
          <span>Tambah</span>
        </button>
      </div>
    </div>

    <!-- TABLE REQUEST -->
    <div class="table-container border-2 border-gray-200 rounded-xl mb-6">
      <table id="requestTable" class="w-full min-w-[600px]">
        <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
          <tr>
            <th class="px-6 py-4 text-left font-bold text-gray-700 whitespace-nowrap">
              <i class="fas fa-box mr-2 text-blue-500"></i>Item
            </th>
            <th class="px-6 py-4 text-center font-bold text-gray-700 whitespace-nowrap">
              <i class="fas fa-hashtag mr-2 text-blue-500"></i>Qty
            </th>
            <th class="px-6 py-4 text-left font-bold text-gray-700 whitespace-nowrap">
              <i class="fas fa-comment mr-2 text-amber-500"></i>Remarks
            </th>
            <th class="px-6 py-4 text-center font-bold text-gray-700 whitespace-nowrap">
              <i class="fas fa-cog mr-2 text-red-500"></i>Aksi
            </th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- SUBMIT BUTTON -->
    <button 
      id="submitBtn" 
      onclick="submitRequest()" 
      class="w-full bg-gradient-to-r from-blue-500 via-blue-600 to-blue-700 text-white py-5 rounded-xl hover:shadow-2xl transition-all font-black text-lg flex items-center justify-center gap-3 shadow-xl"
    >
      <i class="fas fa-paper-plane text-xl"></i>
      <span>KIRIM REQUEST SEKARANG</span>
    </button>
    
    <p id="msg" class="text-center text-sm mt-4 font-bold min-h-[20px]"></p>
  </div>

  <!-- LIST TICKET -->
  <div class="card-premium p-6 md:p-8 animate-slideUp" style="animation-delay: 0.2s;">
    <div class="flex items-center gap-3 mb-6 pb-4 border-b-2 border-gray-100">
      <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center shadow-lg">
        <i class="fas fa-list-alt text-white text-xl"></i>
      </div>
      <div>
        <h2 class="text-2xl font-bold text-gray-800">Riwayat Request</h2>
        <p class="text-sm text-gray-500 mt-0.5">Daftar semua ticket Anda</p>
      </div>
    </div>
    
    <ul id="ticketList" class="space-y-4"></ul>
    
    <div id="emptyState" class="text-center py-12 hidden">
      <div class="w-20 h-20 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4">
        <i class="fas fa-inbox text-4xl text-gray-400"></i>
      </div>
      <p class="text-gray-500 font-semibold">Belum ada ticket request</p>
      <p class="text-sm text-gray-400 mt-1">Buat request baru untuk memulai</p>
    </div>
  </div>

</div>

<script>
const BASE_URL = 'https://script.google.com/macros/s/AKfycbylUW-XSL7i-hzFb6PjMmy_T-zYWUaZ8lnGpHsGUiklZ5mDQBo9zHJ8vJFfmwA5SMQNGQ/exec';
const store_code = localStorage.getItem("store_code");
const store_name = localStorage.getItem("store_name");

if (!store_code) {
  window.location.href = "login.html";
}

// Display store name
if (store_name) {
  document.getElementById("store_name_display").textContent = store_name;
}

let items = [];
let selectedItems = [];

async function loadItems() {
  try {
    const res = await fetch(`${BASE_URL}?action=getItems`, { cache: "no-cache" });
    items = await res.json();
  } catch (e) {
    console.error("Gagal load items", e);
  }
}

function filterItems(v) {
  const list = document.getElementById("itemList");
  list.innerHTML = "";
  
  if (!v || v.length < 2) {
    list.classList.add("hidden");
    return;
  }
  
  const filtered = items.filter(it => 
    it.item_name.toLowerCase().includes(v.toLowerCase()) ||
    it.item_id.toLowerCase().includes(v.toLowerCase())
  );
  
  if (filtered.length === 0) {
    list.innerHTML = `
      <div class="p-4 text-center text-gray-500">
        <i class="fas fa-search text-2xl mb-2"></i>
        <p class="text-sm font-semibold">Item tidak ditemukan</p>
      </div>
    `;
    list.classList.remove("hidden");
    return;
  }
  
  filtered.slice(0, 8).forEach(it => {
    const div = document.createElement("div");
    div.innerHTML = `
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg flex items-center justify-center flex-shrink-0">
          <i class="fas fa-cube text-blue-600"></i>
        </div>
        <div class="flex-1 min-w-0">
          <p class="font-bold text-gray-800 truncate">${it.item_name}</p>
          <p class="text-xs text-gray-500">${it.item_id}${it.category ? ' • ' + it.category : ''}</p>
        </div>
      </div>
    `;
    div.className = "dropdown-item p-4 cursor-pointer border-b last:border-b-0";
    div.onclick = () => selectItem(it);
    list.appendChild(div);
  });
  
  list.classList.remove("hidden");
}

function selectItem(it) {
  const input = document.getElementById("itemSearch");
  input.value = it.item_name;
  input.dataset.itemId = it.item_id;
  input.dataset.category = it.category || "";
  document.getElementById("itemList").classList.add("hidden");
  document.getElementById("qty").focus();
}

function addItem() {
  const input = document.getElementById("itemSearch");
  const item_name = input.value;
  const item_id = input.dataset.itemId;
  const category = input.dataset.category || "";
  const qty = document.getElementById("qty").value;
  const remarks = document.getElementById("remarks").value;
  
  if (!item_id) {
    alert("⚠️ Pilih item dari dropdown!");
    return;
  }
  
  if (!qty || qty <= 0) {
    alert("⚠️ Masukkan jumlah quantity yang valid!");
    return;
  }
  
  selectedItems.push({ item_id, item_name, qty, remarks, category });
  renderTable();
  
  // Reset form
  input.value = "";
  input.dataset.itemId = "";
  input.dataset.category = "";
  document.getElementById("qty").value = "";
  document.getElementById("remarks").value = "";
  input.focus();
}

function renderTable() {
  const tbody = document.querySelector("#requestTable tbody");
  
  if (selectedItems.length === 0) {
    tbody.innerHTML = `
      <tr>
        <td colspan="4" class="px-6 py-12 text-center text-gray-500">
          <i class="fas fa-inbox text-4xl mb-3"></i>
          <p class="font-semibold">Belum ada item ditambahkan</p>
          <p class="text-sm text-gray-400 mt-1">Gunakan form di atas untuk menambah item</p>
        </td>
      </tr>
    `;
    return;
  }
  
  tbody.innerHTML = "";
  selectedItems.forEach((it, idx) => {
    tbody.innerHTML += `
      <tr class='border-b hover:bg-gradient-to-r hover:from-blue-50 hover:to-blue-100 transition-all'>
        <td class='px-6 py-4'>
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg flex items-center justify-center flex-shrink-0">
              <i class="fas fa-cube text-blue-600 text-sm"></i>
            </div>
            <div class="min-w-0">
              <p class="font-bold text-gray-800">${it.item_name}</p>
              <p class="text-xs text-gray-500">${it.item_id}</p>
            </div>
          </div>
        </td>
        <td class='px-6 py-4 text-center'>
          <span class="inline-block px-4 py-2 bg-gradient-to-br from-blue-500 to-blue-600 text-white font-black rounded-lg shadow-lg">
            ${it.qty}
          </span>
        </td>
        <td class='px-6 py-4 text-gray-600 font-medium'>${it.remarks || '-'}</td>
        <td class='px-6 py-4 text-center'>
          <button 
            onclick='removeItem(${idx})' 
            class='px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:shadow-xl transition-all font-bold'
          >
            <i class='fas fa-trash mr-2'></i>Hapus
          </button>
        </td>
      </tr>
    `;
  });
}

function removeItem(i) {
  selectedItems.splice(i, 1);
  renderTable();
}

async function submitRequest() {
  if (selectedItems.length === 0) {
    alert("⚠️ Tambahkan minimal satu item!");
    return;
  }
  
  const btn = document.getElementById("submitBtn");
  const msg = document.getElementById("msg");
  
  btn.disabled = true;
  btn.innerHTML = "<i class='fas fa-spinner fa-spin text-xl'></i> <span>Mengirim request...</span>";
  msg.innerText = "";
  
  try {
    const res = await fetch(BASE_URL, {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: new URLSearchParams({
        action: "submitRequest",
        store_code,
        items: JSON.stringify(selectedItems)
      })
    });
    
    const data = await res.json();
    
    if (data.success) {
      msg.innerText = `✅ Berhasil! Ticket ID: ${data.ticket_id}`;
      msg.className = "text-center text-sm mt-4 font-bold text-green-600 min-h-[20px]";
      
      selectedItems = [];
      renderTable();
      loadTickets();
      
      // Scroll to tickets
      setTimeout(() => {
        document.getElementById("ticketList").scrollIntoView({ behavior: 'smooth' });
      }, 500);
    } else {
      throw new Error("submit failed");
    }
  } catch (e) {
    console.error(e);
    msg.innerText = "❌ Terjadi kesalahan. Silakan coba lagi.";
    msg.className = "text-center text-sm mt-4 font-bold text-red-600 min-h-[20px]";
  }
  
  btn.disabled = false;
  btn.innerHTML = '<i class="fas fa-paper-plane text-xl"></i><span>KIRIM REQUEST SEKARANG</span>';
}

async function loadTickets() {
  try {
    const res = await fetch(`${BASE_URL}?action=getRequests&store_code=${store_code}`, { cache: "no-cache" });
    const data = await res.json();
    const ticketList = document.getElementById("ticketList");
    const emptyState = document.getElementById("emptyState");
    
    const uniqueTickets = [...new Set(data.map(r => r.ticket_id))];
    
    if (uniqueTickets.length === 0) {
      ticketList.innerHTML = "";
      emptyState.classList.remove("hidden");
      return;
    }
    
    emptyState.classList.add("hidden");
    ticketList.innerHTML = "";
    
    uniqueTickets.forEach(t => {
      const tData = data.filter(r => r.ticket_id === t);
      
      // Compute status
      const statuses = tData.map(r => (r.status || "Pending"));
      const allA = statuses.length > 0 && statuses.every(s => s === 'Approved');
      const allR = statuses.length > 0 && statuses.every(s => s === 'Rejected');
      const st = allA ? 'Approved' : allR ? 'Rejected' : (statuses.some(s => s === 'Approved' || s === 'Rejected') ? 'Partial' : 'Pending');
      
      // Status badge
      const statusBadge = {
        'Approved': '<span class="badge-approved px-4 py-2 rounded-full text-xs font-black text-white"><i class="fas fa-check-circle mr-1"></i>APPROVED</span>',
        'Rejected': '<span class="badge-rejected px-4 py-2 rounded-full text-xs font-black text-white"><i class="fas fa-times-circle mr-1"></i>REJECTED</span>',
        'Partial': '<span class="badge-partial px-4 py-2 rounded-full text-xs font-black text-white"><i class="fas fa-adjust mr-1"></i>PARTIAL</span>',
        'Pending': '<span class="badge-pending px-4 py-2 rounded-full text-xs font-black text-white"><i class="fas fa-clock mr-1"></i>PENDING</span>'
      };
      
      const div = document.createElement("div");
      div.className = "p-5 bg-gradient-to-r from-white to-gray-50 border-2 border-gray-200 rounded-xl hover:border-blue-400 hover:shadow-xl cursor-pointer transition-all";
      div.innerHTML = `
        <div class='flex justify-between items-center'>
          <div class='flex items-center gap-3'>
            <div class="w-10 h-10 bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl flex items-center justify-center">
              <i class='fas fa-ticket-alt text-purple-600'></i>
            </div>
            <div>
              <p class='font-black text-gray-800 text-lg'>Ticket #${t}</p>
              <p class='text-xs text-gray-500 font-semibold mt-0.5'>
                <i class="far fa-calendar mr-1"></i>${tData[0].created_at || 'N/A'}
              </p>
            </div>
          </div>
          ${statusBadge[st]}
        </div>
      `;
      
      const container = document.createElement("div");
      container.className = "ticket-detail-container";
      container.style.marginTop = "0";
      
      div.onclick = () => showTicketDetailInline(div, container, t, tData);
      
      ticketList.appendChild(div);
      ticketList.appendChild(container);
    });
  } catch (e) {
    console.error("loadTickets failed", e);
  }
}

function showTicketDetailInline(card, container, id, items) {
  const isOpen = container.innerHTML.trim() !== "";
  
  // Close all
  document.querySelectorAll(".ticket-detail-container").forEach(c => c.innerHTML = "");
  
  if (isOpen) return;
  
  const html = `
    <div class='p-6 bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 border-2 border-purple-200 rounded-xl mt-4 shadow-lg'>
      <div class="flex justify-between items-start mb-4">
        <h4 class='font-black text-xl text-gray-800 flex items-center gap-2'>
          <i class="fas fa-list-ul text-purple-600"></i>
          Detail Ticket #${id}
        </h4>
        <button 
          onclick="document.querySelectorAll('.ticket-detail-container').forEach(c=>c.innerHTML='')" 
          class="px-4 py-2 rounded-lg bg-white hover:bg-gray-100 font-bold text-gray-700 shadow-md transition-all"
        >
          <i class="fas fa-times mr-2"></i>Tutup
        </button>
      </div>
      
      <div class="table-container border-2 border-gray-200 rounded-xl">
        <table class='w-full text-sm min-w-[700px]'>
          <thead class='bg-gradient-to-r from-gray-100 to-gray-200'>
            <tr>
              <th class='px-4 py-3 text-left font-bold text-gray-700'>
                <i class="fas fa-box mr-2 text-purple-500"></i>Item
              </th>
              <th class='px-4 py-3 text-center font-bold text-gray-700'>
                <i class="fas fa-hashtag mr-2 text-blue-500"></i>Qty
              </th>
              <th class='px-4 py-3 text-left font-bold text-gray-700'>
                <i class="fas fa-comment mr-2 text-amber-500"></i>Remarks
              </th>
              <th class='px-4 py-3 text-center font-bold text-gray-700'>
                <i class="fas fa-info-circle mr-2 text-green-500"></i>Status
              </th>
              <th class='px-4 py-3 text-left font-bold text-gray-700'>
                <i class="fas fa-reply mr-2 text-red-500"></i>Feedback
              </th>
            </tr>
          </thead>
          <tbody class="bg-white">
            ${items.map(r => {
              const statusClass = 
                (r.status === 'Approved') ? 'badge-approved' :
                (r.status === 'Rejected') ? 'badge-rejected' :
                (r.status === 'Partial') ? 'badge-partial' : 'badge-pending';
              
              return `
                <tr class='border-t hover:bg-gray-50 transition-all'>
                  <td class='px-4 py-3'>
                    <div class="flex items-center gap-2">
                      <i class="fas fa-cube text-purple-500"></i>
                      <div>
                        <p class="font-bold text-gray-800">${r.item_name}</p>
                        <p class="text-xs text-gray-500">${r.item_id}</p>
                      </div>
                    </div>
                  </td>
                  <td class='px-4 py-3 text-center'>
                    <span class="inline-block px-3 py-1 bg-blue-500 text-white font-black rounded-lg">${r.qty}</span>
                  </td>
                  <td class='px-4 py-3 text-gray-600 font-medium'>${r.remarks || '-'}</td>
                  <td class='px-4 py-3 text-center'>
                    <span class='${statusClass} px-3 py-1 rounded-full text-xs text-white font-bold inline-block'>
                      ${r.status || 'Pending'}
                    </span>
                  </td>
                  <td class='px-4 py-3 text-gray-600 font-medium'>${r.feedback || '-'}</td>
                </tr>
              `;
            }).join("")}
          </tbody>
        </table>
      </div>
    </div>
  `;
  
  container.innerHTML = html;
}

function logout() {
  if (confirm("Yakin ingin keluar?")) {
    localStorage.clear();
    window.location.href = "login.html";
  }
}

// Initialize
loadItems();
loadTickets();
renderTable();
</script>

</body>
</html>